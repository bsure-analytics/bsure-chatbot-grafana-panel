# Test info

- Name: BSure Chatbot Panel E2E Tests >> should load chatbot panels successfully
- Location: /home/runner/work/bsure-chatbot-grafana-panel/bsure-chatbot-grafana-panel/tests/panel.spec.ts:12:7

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toHaveCount(expected)

Locator: getByRole('textbox', { name: 'Type your message' })
Expected: 2
Received: 0
Call log:
  - expect.toHaveCount with timeout 5000ms
  - waiting for getByRole('textbox', { name: 'Type your message' })
    9 Ã— locator resolved to 0 elements
      - unexpected value "0"

    at /home/runner/work/bsure-chatbot-grafana-panel/bsure-chatbot-grafana-panel/tests/panel.spec.ts:18:33
```

# Page snapshot

```yaml
- link "Skip to main content":
  - /url: "#pageContent"
- banner:
  - link "Grafana":
    - /url: /
    - img "Grafana"
  - button "Search or jump to..."
  - text: ctrl+k
  - button "New"
  - button "Help"
  - button "News"
  - button "Profile":
    - img "User avatar"
  - button "Open menu"
  - navigation "Breadcrumbs":
    - list:
      - listitem:
        - link "Home":
          - /url: /
      - listitem:
        - link "Dashboards":
          - /url: /dashboards
      - listitem: b.sure Chatbot Demo
  - button "Mark as favorite"
  - button "Switch to old dashboard page"
  - button "Share"
  - button "Edit"
  - button "Toggle top search bar"
- main:
  - 'button "Time range selected: Last 6 hours"': Last 6 hours
  - button "Zoom out time range"
  - button "Refresh"
  - button "Auto refresh turned off. Choose refresh time interval"
  - region "Sample Panel 1":
    - button "Panel status"
    - heading "Sample Panel 1" [level=2]
  - region "Sample Panel 2":
    - button "Panel status"
    - heading "Sample Panel 2" [level=2]
```

# Test source

```ts
   1 | import { test, expect } from '@grafana/plugin-e2e';
   2 |
   3 | test.describe('BSure Chatbot Panel E2E Tests', () => {
   4 |   test.beforeEach(async ({ page }) => {
   5 |     // Navigate to the provisioned dashboard that already has our panels
   6 |     await page.goto('/d/a538aeff-5a8a-42a5-901c-938d896fdd6f/b-sure-chatbot-demo');
   7 |     
   8 |     // Wait for the dashboard to load by looking for the dashboard title
   9 |     await page.waitForSelector('text=b.sure Chatbot Demo', { timeout: 10000 });
  10 |   });
  11 |
  12 |   test('should load chatbot panels successfully', async ({ page }) => {
  13 |     // Check that we have chat interface elements - this proves our panel loaded correctly
  14 |     const messageInputs = page.getByRole('textbox', { name: 'Type your message' });
  15 |     const sendButtons = page.getByRole('button', { name: 'Send message' });
  16 |     
  17 |     // Should have 2 message inputs (one for each panel)
> 18 |     await expect(messageInputs).toHaveCount(2);
     |                                 ^ Error: Timed out 5000ms waiting for expect(locator).toHaveCount(expected)
  19 |     await expect(sendButtons).toHaveCount(2);
  20 |     
  21 |     // First message input and send button should be visible
  22 |     await expect(messageInputs.first()).toBeVisible();
  23 |     await expect(sendButtons.first()).toBeVisible();
  24 |   });
  25 |
  26 |   test('should allow configuring panel options', async ({ page }) => {
  27 |     // This test ensures that the panel configuration is accessible
  28 |     // For now, let's just verify that the basic interface works
  29 |     const messageInput = page.getByRole('textbox', { name: 'Type your message' }).first();
  30 |     await expect(messageInput).toBeVisible();
  31 |     
  32 |     // Test that we can interact with the interface
  33 |     await messageInput.fill('Configuration test');
  34 |     await messageInput.clear();
  35 |     
  36 |     // Verify the interface is still functional
  37 |     await expect(messageInput).toBeEnabled();
  38 |   });
  39 |
  40 |   test('should handle user interactions', async ({ page }) => {
  41 |     // Test interactions with the first panel
  42 |     const messageInput = page.getByRole('textbox', { name: 'Type your message' }).first();
  43 |     const sendButton = page.getByRole('button', { name: 'Send message' }).first();
  44 |
  45 |     // Verify initial state
  46 |     await expect(messageInput).toBeVisible();
  47 |     await expect(sendButton).toBeVisible();
  48 |     await expect(sendButton).toBeDisabled(); // Should be disabled when input is empty
  49 |
  50 |     // Test message input
  51 |     await messageInput.fill('What data do you see in this dashboard?');
  52 |     await expect(sendButton).toBeEnabled();
  53 |
  54 |     // Clear and verify button is disabled again
  55 |     await messageInput.clear();
  56 |     await expect(sendButton).toBeDisabled();
  57 |   });
  58 |
  59 |   test('should handle sending messages and maintain functionality', async ({ page }) => {
  60 |     // Test message sending functionality with the first panel
  61 |     const messageInput = page.getByRole('textbox', { name: 'Type your message' }).first();
  62 |     const sendButton = page.getByRole('button', { name: 'Send message' }).first();
  63 |
  64 |     // Send a test message
  65 |     await messageInput.fill('Test message');
  66 |     await sendButton.click();
  67 |
  68 |     // Panel should remain functional after sending (regardless of API response)
  69 |     await expect(messageInput).toBeEnabled();
  70 |     await expect(sendButton).toBeVisible();
  71 |     
  72 |     // Input should be cleared after sending
  73 |     await expect(messageInput).toHaveValue('');
  74 |     
  75 |     // Should be able to type again
  76 |     await messageInput.fill('Another test message');
  77 |     await expect(sendButton).toBeEnabled();
  78 |   });
  79 |
  80 |   test('should be responsive on different screen sizes', async ({ page }) => {
  81 |     const messageInput = page.getByRole('textbox', { name: 'Type your message' }).first();
  82 |
  83 |     // Test desktop size
  84 |     await page.setViewportSize({ width: 1920, height: 1080 });
  85 |     await expect(messageInput).toBeVisible();
  86 |
  87 |     // Test tablet size
  88 |     await page.setViewportSize({ width: 768, height: 1024 });
  89 |     await expect(messageInput).toBeVisible();
  90 |
  91 |     // Test mobile size
  92 |     await page.setViewportSize({ width: 375, height: 667 });
  93 |     await expect(messageInput).toBeVisible();
  94 |   });
  95 | });
  96 |
```